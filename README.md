 johnny-grbl
=============

Jhonny-grbl is a utility library that let's you comunicate with grbl. Can be used in 3 ways:

- **Control Mode**: Control an arduino grbl board from javascript. You can send gcode and operate an arduino in a higher abstraction layer than simple character protocol. Jhonny-grbl automatically converts messages for you in simple javascript objects and compose the bytearray request to send, then parses responses from grbl.

- **Mock Mode**: Emulate arduino in javascript. Use your favorite well proved grbl software (bcnc, universal gcode-sender, etc) and pipe the serial port to a remote javascript node server. This server can mock an autentic grbl board, simulate errors, send responses, etc. Can be used to test this programs. jhonny-grbl converts request and responses for you into simple javascript objects.

- **Proxy mode**. The most interesting part: Grbl usually is installed in arduino UNO with limited I/O ports. Although what he does he does very well, in real professional machines you surely need much more I/O ports and you need to extend the logic to its machine concrete aspects (more tools, more sensors, etc). You would need a professional controller with posibility of extending I/Os which is much more expensive $$$$$...

> Yes, you can install grbl on a mega board with many more ports, but still it may not be enough, and furthermore, it is very  difficult to take advantage of unused ports because it would require mixing your logic with the grbl internals. Without a doubt, *if it is working well, it's not worth getting tangled up inside*.

   In proxy mode, jhonny-grbl stays in the middle, between the host program and the real grbl board. You can control all messages sended and received between this parts and extend the control logic with other arduino boards, all that programmed in high level language (javascript). Examples of use:
    - Custom external automatic tool change by using another arduino board as you need.
    - External sensors send alarms to the grbl host software as if where generated by the grbl board
    - let jogging with custom external hardware
    - execute custom http server and visualize all commands sended and received.
    - integrate with other solutions like external webservices, IOTs, etc.


Internals
=========

- johnny-grbl has been implemented in typescript, so you can use both typescript or javascript.

- It is agnostics in terms of I/O ports or external libraries used to comunicate with, the implementation uses the **core concepts of redux** in mind: https://redux.js.org/introduction/core-concepts but do not have any dependency with redux.

- **Â¿why redux?** redux is a well known library in client side javascript: https://redux.js.org/ ...But redux can also be used in the server side, and it enables the debug and testing required in a complicated environment like this. It promotes simple functional aproach to resolve this kinds of problems where you have tackle with multiple events/state. You are not required to use redux if you want

The library is simply a collection of utilities organized in **3 subpackages**:

- /lib/parsers: utilities for parsing generic request and response messages to-from grbl
- /grbl11: concrete request/response types and parsers for grbl1.1 version. It may be some minnor differences between grbl versions in terms of message formats, so in the future if there is a superior version of grbl (1.2 1.3...) we can reuse almost code with the minimal effort, you only have to realize that if you use message types of grbl11 it surely won't be 100% compatible with the future versions of grbl. You are advised...
- /reducers: reducers modules of each part, using the called "Duck" pattern https://github.com/erikras/ducks-modular-redux In the same javascript module we have store type, actions types, action creators, and reducer.






